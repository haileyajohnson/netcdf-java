10/27/2015

org file size is 172.466 Mb
ratio is 1034.504/172.466 = 6.0

Mb / sec =
CDM : avg= 8.99 std=.0725
DODS: avg= 9.53 std=.237

================
opendap compression

compress: avg= 9.52 std=10.0 MB/sec
nocomprs: avg= 11.7 std=2.92 MB/sec

------Reading filename dods://localhost:8081/thredds/dodsC/scanCdmUnitTests/formats/grib1/Mercator.grib1
 bytes = 22793092 took =3.114259 secs rate=7.318946 MB/sec

------Reading filename dods://localhost:8081/thredds/dodsC/scanCdmUnitTests/formats/grib1/Mercator.grib1
 bytes = 22793092 took =11.440733 secs rate=1.992276 MB/sec

------Reading filename dods://localhost:8081/thredds/dodsC/scanCdmUnitTests/formats/grib1/Mercator.grib1
 bytes = 22793092 took =1.815537 secs rate=12.554460 MB/sec

------Reading filename dods://localhost:8081/thredds/dodsC/scanCdmUnitTests/formats/grib1/Mercator.grib1
 bytes = 22793092 took =11.360528 secs rate=2.006341 MB/sec

------Reading filename dods://localhost:8081/thredds/dodsC/scanCdmUnitTests/formats/grib2/ds.pop12.bin
 bytes = 38450816 took =2.729305 secs rate=14.088133 MB/sec

------Reading filename dods://localhost:8081/thredds/dodsC/scanCdmUnitTests/formats/grib2/ds.pop12.bin
 bytes = 38450816 took =1.560333 secs rate=24.642703 MB/sec

------Reading filename dods://localhost:8081/thredds/dodsC/scanCdmUnitTests/formats/grib2/ds.pop12.bin
 bytes = 38450816 took =2.549726 secs rate=15.080372 MB/sec

------Reading filename dods://localhost:8081/thredds/dodsC/scanCdmUnitTests/formats/grib2/ds.pop12.bin
 bytes = 38450816 took =1.494543 secs rate=25.727480 MB/sec

------Reading filename dods://localhost:8081/thredds/dodsC/scanCdmUnitTests/formats/grib2/AVOR_000.grb
 bytes = 27036128 took =3.079090 secs rate=8.780559 MB/sec

------Reading filename dods://localhost:8081/thredds/dodsC/scanCdmUnitTests/formats/grib2/AVOR_000.grb
 bytes = 27036128 took =10.175814 secs rate=2.656901 MB/sec

------Reading filename dods://localhost:8081/thredds/dodsC/scanCdmUnitTests/formats/grib2/AVOR_000.grb
 bytes = 27036128 took =2.846230 secs rate=9.498927 MB/sec

------Reading filename dods://localhost:8081/thredds/dodsC/scanCdmUnitTests/formats/grib2/AVOR_000.grb
 bytes = 27036128 took =9.540854 secs rate=2.833722 MB/sec

gzip: avg= 9.97 std=10.7 MB/sec
none: avg= 11.2 std=2.85 MB/sec

Process finished with exit code 0
------------------------------------------------------------------

cdmremote (avg 4)

compress: avg= 17.1 std=11.9 MB/sec
nocomprs: avg= 10.8 std=1.87 MB/sec


------Reading filename cdmremote://localhost:8081/thredds/cdmremote/scanCdmUnitTests/formats/grib1/Mercator.grib1 (nocomprs)
 bytes = 22793092 took =3.287661 secs rate=6.932921 MB/sec

------Reading filename cdmremote://localhost:8081/thredds/cdmremote/scanCdmUnitTests/formats/grib1/Mercator.grib1 (compress)
Deflate = 320 / 75 = 4.266667
Deflate = 3187296 / 1002927 = 3.177994
Deflate = 531216 / 178390 = 2.977835
Deflate = 531216 / 262840 = 2.021062
Deflate = 531216 / 263767 = 2.013959
Deflate = 531216 / 210629 = 2.522046
Deflate = 3187296 / 1341478 = 2.375958
Deflate = 531216 / 214614 = 2.475216
Deflate = 3187296 / 1353379 = 2.355065
Deflate = 2124864 / 816845 = 2.601306
Deflate = 531216 / 152323 = 3.487431
Deflate = 3187296 / 974258 = 3.271511
Deflate = 531216 / 125406 = 4.235970
Deflate = 505920 / 120427 = 4.201051
Deflate = 505920 / 86277 = 5.863904
Deflate = 3187296 / 1687714 = 1.888528
 bytes = 22793092 took =2.499580 secs rate=9.118769 MB/sec

------Reading filename cdmremote://localhost:8081/thredds/cdmremote/scanCdmUnitTests/formats/grib1/Mercator.grib1 (nocomprs)
 bytes = 22793092 took =1.738912 secs rate=13.107678 MB/sec

------Reading filename cdmremote://localhost:8081/thredds/cdmremote/scanCdmUnitTests/formats/grib1/Mercator.grib1 (compress)
Deflate = 320 / 75 = 4.266667
Deflate = 3187296 / 1002927 = 3.177994
Deflate = 531216 / 178390 = 2.977835
Deflate = 531216 / 262840 = 2.021062
Deflate = 531216 / 263767 = 2.013959
Deflate = 531216 / 210629 = 2.522046
Deflate = 3187296 / 1341478 = 2.375958
Deflate = 531216 / 214614 = 2.475216
Deflate = 3187296 / 1353379 = 2.355065
Deflate = 2124864 / 816845 = 2.601306
Deflate = 531216 / 152323 = 3.487431
Deflate = 3187296 / 974258 = 3.271511
Deflate = 531216 / 125406 = 4.235970
Deflate = 505920 / 120427 = 4.201051
Deflate = 505920 / 86277 = 5.863904
Deflate = 3187296 / 1687714 = 1.888528
 bytes = 22793092 took =2.547560 secs rate=8.947029 MB/sec

------Reading filename cdmremote://localhost:8081/thredds/cdmremote/scanCdmUnitTests/formats/grib2/ds.pop12.bin (nocomprs)
 bytes = 38450816 took =2.970016 secs rate=12.946332 MB/sec

------Reading filename cdmremote://localhost:8081/thredds/cdmremote/scanCdmUnitTests/formats/grib2/ds.pop12.bin (compress)
Deflate = 208 / 53 = 3.924528
Deflate = 38443444 / 774954 = 49.607388
 bytes = 38450816 took =1.062168 secs rate=36.200303 MB/sec

------Reading filename cdmremote://localhost:8081/thredds/cdmremote/scanCdmUnitTests/formats/grib2/ds.pop12.bin (nocomprs)
 bytes = 38450816 took =2.848396 secs rate=13.499110 MB/sec

------Reading filename cdmremote://localhost:8081/thredds/cdmremote/scanCdmUnitTests/formats/grib2/ds.pop12.bin (compress)
Deflate = 208 / 53 = 3.924528
Deflate = 38443444 / 774954 = 49.607388
 bytes = 38450816 took =1.046508 secs rate=36.742026 MB/sec

------Reading filename cdmremote://localhost:8081/thredds/cdmremote/scanCdmUnitTests/formats/grib2/AVOR_000.grb (nocomprs)
 bytes = 27036128 took =3.298322 secs rate=8.196934 MB/sec

------Reading filename cdmremote://localhost:8081/thredds/cdmremote/scanCdmUnitTests/formats/grib2/AVOR_000.grb (compress)
Deflate = 27031680 / 7709415 = 3.506320
 bytes = 27036128 took =3.083570 secs rate=8.767800 MB/sec

------Reading filename cdmremote://localhost:8081/thredds/cdmremote/scanCdmUnitTests/formats/grib2/AVOR_000.grb (nocomprs)
 bytes = 27036128 took =3.139911 secs rate=8.610475 MB/sec

------Reading filename cdmremote://localhost:8081/thredds/cdmremote/scanCdmUnitTests/formats/grib2/AVOR_000.grb (compress)
Deflate = 27031680 / 7709415 = 3.506320
 bytes = 27036128 took =3.033850 secs rate=8.911491 MB/sec

compress: avg= 18.1 std=12.9 MB/sec
nocomprs: avg= 10.5 std=2.68 MB/sec

Process finished with exit code 0

-----------

cdmremote://localhost:8081/thredds/cdmremote/scanCdmUnitTests/formats/grib1/Mercator.grib1 (compress)
 bytes = 22,793092
 compression ratio = 2.592550

 compress: avg= 9.23 std=.208 MB/sec
 nocomprs: avg= 11.3 std=1.80 MB/sec

cdmremote://localhost:8081/thredds/cdmremote/scanCdmUnitTests/formats/grib2/ds.pop12.bin (compress)
 bytes = 3,8450,816
 compression ratio = 49.604264

 compress: avg= 38.5 std=1.32 MB/sec
 nocomprs: avg= 13.0 std=1.12 MB/sec

cdmremote://localhost:8081/thredds/cdmremote/scanCdmUnitTests/formats/grib2/AVOR_000.grb (compress)
 bytes = 27,036,128
 compression ratio = 3.506321

 compress: avg= 8.73 std=.145 MB/sec
 nocomprs: avg= 8.27 std=.819 MB/sec

cdmremote://localhost:8081/thredds/cdmremote/scanCdmUnitTests/conventions/cf/bora_feb_001.nc (compress)
 bytes = 6,884,209
 compression ratio = 1.533374

 compress: avg= 8.04 std=.640 MB/sec
 nocomprs: avg= 10.2 std=2.25 MB/sec

cdmremote://localhost:8081/thredds/cdmremote/scanCdmUnitTests/conventions/cf/ccsm2.nc (compress)
 bytes = 43,683676
 compression ratio = 1.600860

 compress: avg= 9.46 std=.372 MB/sec
 nocomprs: avg= 10.9 std=.944 MB/sec

 ---------------------------------------
 compare dods vs cdm, no compression

 ------ filename scanCdmUnitTests/formats/grib1/Mercator.grib1
  CDM : avg=11.4 std=1.46 (n=10) MB/sec
  DODS: avg=12.6 std=.337 (n=10) MB/sec

 ------ filename scanCdmUnitTests/formats/grib2/ds.pop12.bin
  CDM : avg=14.7 std=1.12 (n=10) MB/sec
  DODS: avg=17.6 std=1.87 (n=10) MB/sec

 ------ filename scanCdmUnitTests/formats/grib2/AVOR_000.grb
  CDM : avg=8.96 std=.934 (n=10) MB/sec
  DODS: avg=10.1 std=.470 (n=10) MB/sec
 compression ratio = 3.506321

 ------ filename scanCdmUnitTests/conventions/cf/bora_feb_001.nc
  CDM : avg=10.7 std=.817 (n=10) MB/sec
  DODS: avg=10.3 std=1.51 (n=10) MB/sec

 ------ filename scanCdmUnitTests/conventions/cf/ccsm2.nc
  CDM : avg=11.8 std=.412 (n=10) MB/sec
  DODS: avg=11.2 std=.461 (n=10) MB/sec

  CDM : avg=11.5 std=2.14 (n=50) MB/sec
  DODS: avg=12.4 std=2.97 (n=50) MB/sec

----------

------ filename scanCdmUnitTests/formats/grib1/Mercator.grib1
CDM2: avg=13.5 std=1.72 (n=10) MB/sec

------ filename scanCdmUnitTests/formats/grib2/ds.pop12.bin
CDM2: avg=15.4 std=.497 (n=10) MB/sec

------ filename scanCdmUnitTests/formats/grib2/AVOR_000.grb
CDM2: avg=9.45 std=.519 (n=10) MB/sec

------ filename scanCdmUnitTests/conventions/cf/bora_feb_001.nc
CDM2: avg=11.9 std=.637 (n=10) MB/sec

------ filename scanCdmUnitTests/conventions/cf/ccsm2.nc
CDM2: avg=13.6 std=.383 (n=10) MB/sec

total
CDM2: avg=12.8 std=2.19 (n=50) MB/sec

-----------------------------------------------------------------
100K buffered input stream

------ filename scanCdmUnitTests/formats/grib1/Mercator.grib1
 CDM4: avg=13.5 std=1.73 (n=10) MB/sec

------ filename scanCdmUnitTests/formats/grib2/ds.pop12.bin
 CDM4: avg=15.5 std=.300 (n=10) MB/sec

------ filename scanCdmUnitTests/formats/grib2/AVOR_000.grb
 CDM4: avg=9.65 std=.180 (n=10) MB/sec

------ filename scanCdmUnitTests/conventions/cf/bora_feb_001.nc
 CDM4: avg=12.1 std=.686 (n=10) MB/sec

------ filename scanCdmUnitTests/conventions/cf/ccsm2.nc
 CDM4: avg=13.1 std=.279 (n=10) MB/sec

-----------------------------------------------------------------
40K buffered input stream

------ filename scanCdmUnitTests/formats/grib1/Mercator.grib1
 CDM4: avg=13.2 std=2.42 (n=10) MB/sec

------ filename scanCdmUnitTests/formats/grib2/ds.pop12.bin
 CDM4: avg=15.4 std=.641 (n=10) MB/sec

------ filename scanCdmUnitTests/formats/grib2/AVOR_000.grb
 CDM4: avg=9.53 std=.243 (n=10) MB/sec

------ filename scanCdmUnitTests/conventions/cf/bora_feb_001.nc
 CDM4: avg=11.6 std=.830 (n=10) MB/sec

------ filename scanCdmUnitTests/conventions/cf/ccsm2.nc
 CDM4: avg=13.3 std=.359 (n=10) MB/sec

 CDM4: avg=12.6 std=2.29 (n=50) MB/sec

-----------------
no buffer, use Delimited read/write

------ filename scanCdmUnitTests/formats/grib1/Mercator.grib1
 CDM4: avg=14.3 std=1.42 (n=20) MB/sec

------ filename scanCdmUnitTests/formats/grib2/ds.pop12.bin
 CDM4: avg=15.8 std=.926 (n=20) MB/sec

------ filename scanCdmUnitTests/formats/grib2/AVOR_000.grb
 CDM4: avg=9.79 std=.569 (n=20) MB/sec

------ filename scanCdmUnitTests/conventions/cf/bora_feb_001.nc
 CDM4: avg=12.4 std=1.18 (n=20) MB/sec

------ filename scanCdmUnitTests/conventions/cf/ccsm2.nc
 CDM4: avg=14.0 std=.491 (n=20) MB/sec

 CDM4: avg=13.2 std=2.27 (n=100) MB/sec

===================================================
===================================================
 data transfer dods vs cdm, with/without compression

------ filename scanCdmUnitTests/formats/grib1/Mercator.grib1
  CDM : avg=11.4 std=1.46 (n=10) MB/sec
  DODS: avg=12.6 std=.337 (n=10) MB/sec
  CDM2: avg=13.5 std=1.72 (n=10) MB/sec
  CDM3: avg=12.3 std=1.75 (n=10) MB/sec
  CDM4: avg=13.4 std=1.75 (n=10) MB/sec

compress:
  CDM : avg=8.75 std=1.06 (n=10) MB/sec
  DODS: avg=2.07 std=.0464 (n=10) MB/sec
  compression ratio = 2.592550

------ filename scanCdmUnitTests/formats/grib2/ds.pop12.bin
  CDM : avg=14.7 std=1.12 (n=10) MB/sec
  DODS: avg=17.6 std=1.87 (n=10) MB/sec
  CDM2: avg=15.4 std=.497 (n=10) MB/sec
  CDM3: avg=13.0 std=1.66 (n=10) MB/sec
  CDM4: avg=15.4 std=.690 (n=10) MB/sec

compress:
  CDM : avg=38.1 std=.654 (n=10) MB/sec
  DODS: avg=24.5 std=.988 (n=10) MB/sec
  compression ratio = 49.604264

------ filename scanCdmUnitTests/formats/grib2/AVOR_000.grb
  CDM : avg=8.96 std=.934 (n=10) MB/sec
  DODS: avg=10.1 std=.470 (n=10) MB/sec
  CDM2: avg=9.45 std=.519 (n=10) MB/sec
  CDM3: avg=8.77 std=.548 (n=10) MB/sec
  CDM4: avg=9.38 std=.210 (n=10) MB/sec

compress:
  CDM : avg=8.94 std=.374 (n=10) MB/sec
  DODS: avg=2.92 std=.0769 (n=10) MB/sec
  compression ratio = 3.506321

------ filename scanCdmUnitTests/conventions/cf/bora_feb_001.nc
  CDM : avg=10.7 std=.817 (n=10) MB/sec
  DODS: avg=10.3 std=1.51 (n=10) MB/sec
  CDM2: avg=11.9 std=.637 (n=10) MB/sec
  CDM3: avg=11.5 std=.865 (n=10) MB/sec
  CDM4: avg=11.5 std=1.08 (n=10) MB/sec

compress:
 CDM : avg=8.14 std=.361 (n=10) MB/sec
 DODS: avg=1.81 std=.0522 (n=10) MB/sec
 compression ratio = 1.533374

------ filename scanCdmUnitTests/conventions/cf/ccsm2.nc
  CDM : avg=11.8 std=.412 (n=10) MB/sec
  DODS: avg=11.2 std=.461 (n=10) MB/sec
  CDM2: avg=13.6 std=.383 (n=10) MB/sec
  CDM3: avg=12.7 std=.302 (n=10) MB/sec
  CDM4: avg=13.2 std=.228 (n=10) MB/sec

compress:
  CDM : avg=9.34 std=.435 (n=10) MB/sec
  DODS: avg=1.94 std=.0773 (n=10) MB/sec
  compression ratio = 1.600860

total
  CDM : avg=11.5 std=2.14 (n=50) MB/sec
  DODS: avg=12.4 std=2.97 (n=50) MB/sec
  CDM2: avg=12.8 std=2.19 (n=50) MB/sec
  CDM3: avg=11.7 std=1.95 (n=50) MB/sec
  CDM4: avg=12.6 std=2.25 (n=50) MB/sec

compress:
  CDM : avg=14.6 std=11.7 (n=50) MB/sec
  DODS: avg=6.65 std=8.95 (n=50) MB/sec

Conclusions
 compression
  ds.pop12.bin distorts compression result, in fact most dods files are very bad (tomcat?), and cdm somewhat worse in compression
  client/server on the same machine, so not bandwidth limited; need to test compression across network
  needs more study on usefullness, for now client leave default off, server compress if asked.

 CDM algo
  not clear if these results are statistically significant, but they seem to be stable.
  CDM2 10% faster in this test.
    CDM: current, with data outside of proto. not sure why proto is faster. ByteBuffer.wrap() does not have to make extra copy.
    CDM2: proto with byte array, has extra copy ByteString -> ByteBuffer -> Array
    CDM3: proto with repeating arrays, converts to Objects, proto -> ArrayList<Object> -> Array.
    CDM4: same as CDM2, using writeToDelimited() and parseFromDelimited() - handles message delimiting

 CDM vs DODS
  not clear if these results are statistically significant, but they seem to be stable.
  ignore compress for now.


